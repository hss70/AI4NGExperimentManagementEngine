{
	"info": {
		"name": "AI4NG Automated Test Suite",
		"description": "Automated test suite for AI4NG API - Run with Collection Runner",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "ðŸ” Authentication",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Copy global variables to collection variables",
							"pm.collectionVariables.set('apiGatewayUrl', pm.globals.get('apiGatewayUrl'));",
							"pm.collectionVariables.set('cognitoClientId', pm.globals.get('cognitoClientId'));",
							"pm.collectionVariables.set('username', pm.globals.get('username'));",
							"pm.collectionVariables.set('password', pm.globals.get('password'));",
							"console.log('Using ClientId:', pm.globals.get('cognitoClientId'));"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Authentication successful', function () {",
							"    if (pm.response.code !== 200) {",
							"        const errorResponse = pm.response.json();",
							"        console.error('âŒ Authentication failed:', pm.response.code, errorResponse);",
							"        throw new Error('Authentication failed with status ' + pm.response.code + ': ' + (errorResponse.message || errorResponse.__type || 'Unknown error'));",
							"    }",
							"    ",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response.AuthenticationResult).to.have.property('IdToken');",
							"    pm.collectionVariables.set('idToken', response.AuthenticationResult.IdToken);",
							"    console.log('âœ… Authentication successful');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-amz-json-1.1"
					},
					{
						"key": "X-Amz-Target",
						"value": "AWSCognitoIdentityProviderService.InitiateAuth"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"AuthFlow\": \"USER_PASSWORD_AUTH\",\n    \"ClientId\": \"{{cognitoClientId}}\",\n    \"AuthParameters\": {\n        \"USERNAME\": \"{{username}}\",\n        \"PASSWORD\": \"{{password}}\"\n    }\n}"
				},
				"url": "https://cognito-idp.eu-west-2.amazonaws.com"
			}
		},
		{
			"name": "ðŸ“‹ Create EEG Training Task",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Store original task data for validation",
							"const taskData = {",
							"  name: 'EEG Training Session',",
							"  type: 'eeg_training',",
							"  description: 'EEG-based neurofeedback training session.',",
							"  configuration: { duration: 300, protocol: 'alpha_enhancement' },",
							"  estimatedDuration: 300",
							"};",
							"pm.collectionVariables.set('originalTaskData', JSON.stringify(taskData));"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Task created successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('id');",
							"    pm.collectionVariables.set('taskId', response.id);",
							"    console.log('âœ… Task created:', response.id);",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"EEG Training Session\",\n  \"type\": \"eeg_training\",\n  \"description\": \"EEG-based neurofeedback training session.\",\n  \"configuration\": {\n    \"duration\": 300,\n    \"protocol\": \"alpha_enhancement\"\n  },\n  \"estimatedDuration\": 300\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/tasks",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "tasks"]
				}
			}
		},
		{
			"name": "ðŸ“‹ Create Questionnaire Task",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Questionnaire task created successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('id');",
							"    pm.collectionVariables.set('questionnaireTaskId', response.id);",
							"    console.log('âœ… Questionnaire task created:', response.id);",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Pre-Training State Questionnaire\",\n  \"type\": \"questionnaire\",\n  \"description\": \"Assesses emotional and cognitive readiness before BCI training.\",\n  \"configuration\": {\n    \"questionnaireId\": \"PreState\"\n  },\n  \"estimatedDuration\": 5\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/tasks",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "tasks"]
				}
			}
		},
		{
			"name": "âŒ Test Validation - Missing Questionnaire Task",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Task creation fails with missing questionnaire', function () {",
							"    pm.response.to.have.status(400);",
							"    const response = pm.response.json();",
							"    pm.expect(response.error).to.equal('ValidationError');",
							"    pm.expect(response.missingQuestionnaires).to.include('NonExistentQuestionnaire');",
							"    console.log('âœ… Validation error correctly returned');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Invalid Task\",\n  \"type\": \"questionnaire\",\n  \"description\": \"Task with missing questionnaire\",\n  \"configuration\": {\n    \"questionnaireId\": \"NonExistentQuestionnaire\"\n  },\n  \"estimatedDuration\": 5\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/tasks",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "tasks"]
				}
			}
		},
		{
			"name": "âŒ Test Validation - Missing Questionnaire Experiment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Experiment creation fails with missing questionnaires', function () {",
							"    pm.response.to.have.status(400);",
							"    const response = pm.response.json();",
							"    pm.expect(response.error).to.equal('ValidationError');",
							"    pm.expect(response.missingQuestionnaires).to.be.an('array');",
							"    pm.expect(response.missingQuestionnaires.length).to.be.greaterThan(0);",
							"    console.log('âœ… Experiment validation error correctly returned');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"data\": {\n    \"name\": \"Invalid Experiment\",\n    \"description\": \"Experiment with missing questionnaires\",\n    \"sessionTypes\": {\n      \"DAILY\": {\n        \"name\": \"Daily Session\",\n        \"questionnaires\": [\"MissingQ1\", \"MissingQ2\"],\n        \"estimatedDuration\": 25\n      }\n    }\n  }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments"]
				}
			}
		},
		{
			"name": "ðŸ“ Create PreState Questionnaire",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('PreState questionnaire created successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    console.log('âœ… PreState questionnaire created');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"id\": \"PreState\",\n  \"data\": {\n    \"name\": \"Pre-Training State\",\n    \"description\": \"Assesses emotional and cognitive readiness before BCI training\",\n    \"estimatedTime\": 5,\n    \"questions\": [\n      {\n        \"id\": \"mood\",\n        \"text\": \"How would you rate your current mood?\",\n        \"type\": \"scale\",\n        \"scale\": { \"min\": 1, \"max\": 7 },\n        \"required\": true\n      }\n    ]\n  }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/questionnaires",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "questionnaires"]
				}
			}
		},
		{
			"name": "ðŸ“ Create Required Questionnaires",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Required questionnaires created successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    console.log('âœ… Required questionnaires created');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "[\n  {\"id\": \"PhysicalState\", \"data\": {\"name\": \"Physical State\", \"description\": \"Physical readiness assessment\", \"estimatedTime\": 3, \"questions\": [{\"id\": \"energy\", \"text\": \"Energy level?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}},\n  {\"id\": \"CurrentState\", \"data\": {\"name\": \"Current State\", \"description\": \"Current mental state\", \"estimatedTime\": 3, \"questions\": [{\"id\": \"focus\", \"text\": \"Focus level?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}},\n  {\"id\": \"EndState\", \"data\": {\"name\": \"End State\", \"description\": \"Post-session state\", \"estimatedTime\": 3, \"questions\": [{\"id\": \"satisfaction\", \"text\": \"Session satisfaction?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}},\n  {\"id\": \"PQ\", \"data\": {\"name\": \"Presence Questionnaire\", \"description\": \"Presence assessment\", \"estimatedTime\": 5, \"questions\": [{\"id\": \"presence\", \"text\": \"Sense of presence?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}},\n  {\"id\": \"TLX\", \"data\": {\"name\": \"Task Load Index\", \"description\": \"Workload assessment\", \"estimatedTime\": 5, \"questions\": [{\"id\": \"workload\", \"text\": \"Mental workload?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}},\n  {\"id\": \"IPAQ\", \"data\": {\"name\": \"Physical Activity\", \"description\": \"Physical activity assessment\", \"estimatedTime\": 10, \"questions\": [{\"id\": \"activity\", \"text\": \"Weekly activity level?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}},\n  {\"id\": \"VVIQ\", \"data\": {\"name\": \"Vividness of Visual Imagery\", \"description\": \"Visual imagery assessment\", \"estimatedTime\": 15, \"questions\": [{\"id\": \"imagery\", \"text\": \"Image vividness?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 5}, \"required\": true}]}},\n  {\"id\": \"ATI\", \"data\": {\"name\": \"Absorption Trait Inventory\", \"description\": \"Absorption assessment\", \"estimatedTime\": 10, \"questions\": [{\"id\": \"absorption\", \"text\": \"Absorption level?\", \"type\": \"scale\", \"scale\": {\"min\": 1, \"max\": 7}, \"required\": true}]}}\n]",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/questionnaires/batch",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "questionnaires", "batch"]
				}
			}
		},
		{
			"name": "ðŸ§ª Create Complex BCI Experiment",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Store original experiment data for validation",
							"const expData = {",
							"  name: 'BCI Training Study',",
							"  description: 'A 21-day protocol combining EEG training with daily, weekly, and trait questionnaires.',",
							"  sessionTypes: {",
							"    DAILY: {",
							"      name: 'Daily Session',",
							"      questionnaires: ['PreState', 'PhysicalState', 'CurrentState', 'EndState', 'PQ', 'TLX'],",
							"      estimatedDuration: 25",
							"    },",
							"    WEEKLY: {",
							"      name: 'Weekly Session',",
							"      questionnaires: ['IPAQ'],",
							"      estimatedDuration: 20",
							"    },",
							"    TRAIT: {",
							"      name: 'Trait Questionnaire Session',",
							"      questionnaires: ['VVIQ', 'ATI', 'FMI', 'MIQ-RS', 'Edinburgh', 'MentalRotation', '16PF5', 'IndexLearningStyles'],",
							"      estimatedDuration: 115",
							"    }",
							"  }",
							"};",
							"pm.collectionVariables.set('originalExpData', JSON.stringify(expData));"
						]
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Experiment created successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('id');",
							"    pm.collectionVariables.set('experimentId', response.id);",
							"    console.log('âœ… Experiment created:', response.id);",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"data\": {\n    \"name\": \"BCI Training Study\",\n    \"description\": \"A 21-day protocol combining EEG training with daily, weekly, and trait questionnaires.\",\n    \"sessionTypes\": {\n      \"DAILY\": {\n        \"name\": \"Daily Session\",\n        \"questionnaires\": [\"PreState\", \"PhysicalState\", \"CurrentState\", \"EndState\", \"PQ\", \"TLX\"],\n        \"tasks\": [\"TASK#PRE_STATE\", \"TASK#PHYSICAL_STATE\", \"TASK#TRAIN_EEG\", \"TASK#CURRENT_STATE\", \"TASK#END_STATE\", \"TASK#PQ\", \"TASK#TLX\"],\n        \"estimatedDuration\": 25,\n        \"schedule\": \"daily\"\n      },\n      \"WEEKLY\": {\n        \"name\": \"Weekly Session\",\n        \"questionnaires\": [\"IPAQ\"],\n        \"tasks\": [\"TASK#IPAQ\"],\n        \"estimatedDuration\": 20,\n        \"schedule\": \"weekly\"\n      },\n      \"TRAIT\": {\n        \"name\": \"Trait Questionnaire Session\",\n        \"questionnaires\": [\"VVIQ\", \"ATI\", \"FMI\", \"MIQ-RS\", \"Edinburgh\", \"MentalRotation\", \"16PF5\", \"IndexLearningStyles\"],\n        \"tasks\": [\"TASK#TRAIT_BANK\"],\n        \"estimatedDuration\": 115,\n        \"schedule\": \"once\"\n      }\n    }\n  },\n  \"questionnaireConfig\": {\n    \"schedule\": {\n      \"PreState\": \"every_session\",\n      \"PhysicalState\": \"every_session\",\n      \"CurrentState\": \"every_session\",\n      \"EndState\": \"every_session\",\n      \"PQ\": \"every_session\",\n      \"TLX\": \"every_session\",\n      \"IPAQ\": \"weekly\",\n      \"VVIQ\": \"once\",\n      \"ATI\": \"once\",\n      \"FMI\": \"once\",\n      \"MIQ-RS\": \"once\",\n      \"Edinburgh\": \"once\",\n      \"MentalRotation\": \"once\",\n      \"16PF5\": \"once\",\n      \"IndexLearningStyles\": \"once\"\n    }\n  }\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments"]
				}
			}
		},
		{
			"name": "ðŸ‘¥ Add Member to Experiment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Member added successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('message');",
							"    console.log('âœ… Member added to experiment');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"role\": \"Participant\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/members/test-participant-123",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "members", "test-participant-123"]
				}
			}
		},
		{
			"name": "ðŸ“… Get Experiment Members",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Get members successful', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.be.an('array');",
							"    pm.expect(response.length).to.be.greaterThan(0);",
							"    console.log('âœ… Retrieved', response.length, 'members');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/members",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "members"]
				}
			}
		},
		{
			"name": "âŒ Test Validation - Missing Experiment Session",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Session creation fails with missing experiment', function () {",
							"    pm.response.to.have.status(400);",
							"    const response = pm.response.json();",
							"    pm.expect(response.error).to.equal('ValidationError');",
							"    pm.expect(response.message).to.include('not found');",
							"    console.log('âœ… Session validation error correctly returned');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"sessionType\": \"DAILY\",\n  \"sessionName\": \"Invalid Session\",\n  \"description\": \"Session for non-existent experiment\",\n  \"date\": \"2024-01-15\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/non-existent-experiment/sessions",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "non-existent-experiment", "sessions"]
				}
			}
		},
		{
			"name": "ðŸ“… Create Session",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Session created successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('sessionId');",
							"    pm.collectionVariables.set('sessionId', response.sessionId);",
							"    console.log('âœ… Session created:', response.sessionId);",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"sessionType\": \"DAILY\",\n  \"sessionName\": \"Daily Training Session 1\",\n  \"description\": \"First daily training session with EEG and questionnaires\",\n  \"date\": \"2024-01-15\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/sessions",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "sessions"]
				}
			}
		},
		{
			"name": "ðŸ“Š Get All Experiments",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Get experiments successful', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.be.an('array');",
							"    console.log('âœ… Retrieved', response.length, 'experiments');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments"]
				}
			}
		},
		{
			"name": "âœ… Validate Task Data",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Task data matches uploaded data', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    const original = JSON.parse(pm.collectionVariables.get('originalTaskData'));",
							"    ",
							"    pm.expect(response.data.name).to.equal(original.name);",
							"    pm.expect(response.data.type).to.equal(original.type);",
							"    pm.expect(response.data.description).to.equal(original.description);",
							"    pm.expect(response.data.estimatedDuration).to.equal(original.estimatedDuration);",
							"    pm.expect(response.data.configuration.duration).to.equal(original.configuration.duration);",
							"    ",
							"    console.log('âœ… Task data validation passed');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/tasks/{{taskId}}",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "tasks", "{{taskId}}"]
				}
			}
		},
		{
			"name": "âœ… Validate Experiment Data",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Experiment data matches uploaded data', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    const original = JSON.parse(pm.collectionVariables.get('originalExpData'));",
							"    ",
							"    pm.expect(response.data.name).to.equal(original.name);",
							"    pm.expect(response.data.description).to.equal(original.description);",
							"    pm.expect(response.data.sessionTypes.DAILY.name).to.equal(original.sessionTypes.DAILY.name);",
							"    pm.expect(response.data.sessionTypes.DAILY.estimatedDuration).to.equal(original.sessionTypes.DAILY.estimatedDuration);",
							"    ",
							"    console.log('âœ… Experiment data validation passed');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}"]
				}
			}
		},
		{
			"name": "ðŸ“Š Get All Tasks",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Get tasks successful', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.be.an('array');",
							"    console.log('âœ… Retrieved', response.length, 'tasks');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/tasks",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "tasks"]
				}
			}
		},
		{
			"name": "âœ… Validate Session Data",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Session data matches created session', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    ",
							"    pm.expect(response.data.date).to.equal('2024-01-15');",
							"    pm.expect(response.data.sessionType).to.equal('DAILY');",
							"    pm.expect(response.data.sessionName).to.equal('Daily Training Session 1');",
							"    pm.expect(response.data.description).to.equal('First daily training session with EEG and questionnaires');",
							"    pm.expect(response.sessionId).to.equal(pm.collectionVariables.get('sessionId'));",
							"    ",
							"    console.log('âœ… Session data validation passed');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/sessions/{{sessionId}}",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "sessions", "{{sessionId}}"]
				}
			}
		},
		{
			"name": "ðŸ“Š Get Sessions",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Get sessions successful', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.be.an('array');",
							"    console.log('âœ… Retrieved', response.length, 'sessions');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/sessions",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "sessions"]
				}
			}
		},
		{
			"name": "ðŸ”„ Sync Experiment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Sync successful and data integrity maintained', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    const original = JSON.parse(pm.collectionVariables.get('originalExpData'));",
							"    ",
							"    // Validate sync structure",
							"    pm.expect(response).to.have.property('syncTimestamp');",
							"    pm.expect(response).to.have.property('experiment');",
							"    pm.expect(response).to.have.property('sessions');",
							"    ",
							"    // Validate experiment data in sync response",
							"    pm.expect(response.experiment.data.name).to.equal(original.name);",
							"    pm.expect(response.experiment.data.description).to.equal(original.description);",
							"    ",
							"    // Validate session data in sync response",
							"    pm.expect(response.sessions).to.be.an('array');",
							"    if (response.sessions.length > 0) {",
							"        const session = response.sessions[0];",
							"        pm.expect(session.data.date).to.equal('2024-01-15');",
							"        pm.expect(session.data.sessionType).to.equal('DAILY');",
							"    }",
							"    ",
							"    console.log('âœ… Sync data validation passed');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/sync",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "sync"]
				}
			}
		},
		{
			"name": "ðŸ§¹ Cleanup - Delete Session",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Session deleted successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    console.log('âœ… Session deleted');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/sessions/{{sessionId}}",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "sessions", "{{sessionId}}"]
				}
			}
		},
		{
			"name": "ðŸ§¹ Cleanup - Delete Task",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Task deleted successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('message');",
							"    console.log('âœ… Task deleted');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/tasks/{{taskId}}",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "tasks", "{{taskId}}"]
				}
			}
		},
		{
			"name": "ðŸ§¹ Cleanup - Delete All Questionnaires",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"// Delete all questionnaires",
							"const questionnaires = ['PreState', 'PhysicalState', 'CurrentState', 'EndState', 'PQ', 'TLX', 'IPAQ', 'VVIQ', 'ATI'];",
							"let deletePromises = questionnaires.map(qId => {",
							"    return new Promise((resolve) => {",
							"        pm.sendRequest({",
							"            url: pm.collectionVariables.get('apiGatewayUrl') + '/api/questionnaires/' + qId,",
							"            method: 'DELETE',",
							"            header: { 'Authorization': 'Bearer ' + pm.collectionVariables.get('idToken') }",
							"        }, (err, res) => resolve());",
							"    });",
							"});",
							"Promise.all(deletePromises).then(() => {",
							"    console.log('âœ… All questionnaires cleanup completed');",
							"});",
							"pm.test('Questionnaire cleanup initiated', () => { pm.expect(true).to.be.true; });"
						]
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/questionnaires/PreState",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "questionnaires", "PreState"]
				}
			}
		},
		{
			"name": "ðŸ§¹ Cleanup - Remove Member",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Member removed successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('message');",
							"    console.log('âœ… Member removed');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}/members/test-participant-123",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}", "members", "test-participant-123"]
				}
			}
		},
		{
			"name": "ðŸ§¹ Cleanup - Delete Experiment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test('Experiment deleted successfully', function () {",
							"    pm.response.to.have.status(200);",
							"    const response = pm.response.json();",
							"    pm.expect(response).to.have.property('message');",
							"    console.log('âœ… Experiment deleted');",
							"});"
						]
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer {{idToken}}"
					}
				],
				"url": {
					"raw": "{{apiGatewayUrl}}/api/experiments/{{experimentId}}",
					"host": ["{{apiGatewayUrl}}"],
					"path": ["api", "experiments", "{{experimentId}}"]
				}
			}
		}
	],
	"variable": [
		{
			"key": "apiGatewayUrl",
			"value": ""
		},
		{
			"key": "cognitoClientId",
			"value": ""
		},
		{
			"key": "username",
			"value": ""
		},
		{
			"key": "password",
			"value": ""
		},
		{
			"key": "experimentId",
			"value": ""
		},
		{
			"key": "sessionId",
			"value": ""
		},
		{
			"key": "taskId",
			"value": ""
		}
	]
}